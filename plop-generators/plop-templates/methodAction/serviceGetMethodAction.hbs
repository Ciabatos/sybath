// GENERATED CODE - SHOULD BE EDITED MANUALLY TO END CONFIGURATION - serviceGetMethodAction.hbs
"use server"

import { {{methodParamsTypeName}}, {{methodCamelName}} } from "@/db/postgresMainDatabase/schemas/{{schema}}/{{methodCamelName}}"
import { getActivePlayerServer } from "@/methods/server-fetchers/players/core/getActivePlayerServer"

//MANUAL CODE - START

export type T{{methodPascalName}}ServiceParams = {
sessionUserId: number
playerId: number
}

//MANUAL CODE - END

export async function {{methodCamelName}}Service(params: T{{methodPascalName}}ServiceParams) {
  try {
    const sessionPlayerId = (await getActivePlayerServer({ userId: params.sessionUserId })).raw[0].id
    const playerId = params.playerId

    if (sessionPlayerId !== playerId) {
      return {
        status: false,
        message: "Active player mismatch",
      }
    }

    //MANUAL CODE - START

    {{#each methodParamsColumns}}
    const {{camelName}} =
    {{/each}}

    //MANUAL CODE - END

    const data: {{methodParamsTypeName}} = {
      {{#each methodParamsColumns}}
      {{camelName}}: {{camelName}},
      {{/each}}
    }

    const result = await {{methodCamelName}}(data)
    return result
  } catch (error) {
    console.error("Error {{methodCamelName}}Service :", {
      error,
      params,
      timestamp: new Date().toISOString(),
    })

    return {
      status: false,
      message: "Unexpected error occurred. Please refresh the page.",
    }
  }
}